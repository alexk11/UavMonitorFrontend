<div *ngIf="user" class="card m-3">
  <!--p-dialog header='Сообщение' [modal]="true" [(visible)]="feedbackVisible" [style]="{ width: '25rem' }" (onHide)="feedbackVisible=false">
    <p>{{message}}</p>
    <div class="flex justify-end gap-2">
      <p-button class="d-btn"
                label="Cancel"
                severity="secondary"
                (click)="feedbackVisible=false"/>
      <p-button class="d-btn" label="Ok" (click)="onDialogOk()" />
    </div>
  </p-dialog-->
  <app-info-dialog
    [message]="message"
    [display]="dialogVisible"
    (confirm)="onConfirm()">
  </app-info-dialog>
  <h5 class="card-header fw-bolder">{{title}}</h5>
  <div class="card-body">
    <form [formGroup]="updateForm" (ngSubmit)="onSubmit()">
        <div class="form-group col-4 mb-2">
          <label>Имя</label>
          <input
            type="text"
            formControlName="firstName"
            class="form-control"
            [(ngModel)]="user.surname"
            [ngClass]="{ 'is-invalid': submitted && f.firstName.errors }"
          >
          <div *ngIf="submitted && f.firstName.errors" class="invalid-feedback">
            <div *ngIf="f.firstName.errors.required">
              {{ required }}
            </div>
          </div>
        </div>
        <div class="form-group col-4 mb-2">
          <label>Фамилия</label>
          <input
            type="text"
            formControlName="lastName"
            class="form-control"
            [ngModel]="user.lastname"
            [ngClass]="{ 'is-invalid': submitted && f.lastName.errors }"
          />
          <div *ngIf="submitted && f.lastName.errors" class="invalid-feedback">
            <div *ngIf="f.lastName.errors.required">
              {{ required }}
            </div>
          </div>
        </div>
        <div class="form-group col-4 mb-2">
          <label>Учетная запись (Логин)</label>
          <input
            type="text"
            formControlName="login"
            class="form-control"
            [ngModel]="user.login"
            [ngClass]="{ 'is-invalid': submitted && f.login.errors }"
          />
        </div>
        <div class="form-group col-4 mb-2">
          <label>Пароль</label>
          <input
            type="text"
            formControlName="password"
            class="form-control"
            [ngModel]="user.password"
            [ngClass]="{ 'is-invalid': submitted && f.password.errors }"
          />
          <div *ngIf="submitted && f.password.errors" class="invalid-feedback">
            <div *ngIf="f.password.errors.required">
              {{ required }}
            </div>
          </div>
        </div>
        <div class="form-group col-4 mb-2">
          <label>Роль</label>
          <p-select [options]="roles"
                    formControlName="role"
                    placeholder="Выберите роль"
                    optionLabel="name"
                    class="form-control role-select"
                    [(ngModel)]="selectedRole"
                    [ngClass]="{'is-invalid': submitted && selectedRole.name == ''}">
          </p-select>
          <div *ngIf="submitted && selectedRole.name == ''" class="invalid-feedback">
            {{ required }}
          </div>
        </div>
        <div class="form-group col-4 pt-1">
          <label style="display: block">Активирован</label>
          <!--p-checkbox [(ngModel)]="user.enabled"-->
          <p-checkbox [(ngModel)]="isActivated"
                      [ngModelOptions]="{standalone: true}"
                      binary="true">
          </p-checkbox>
        </div>

      <div class="text-right mt-2 mb-0" style="float: right; margin-right: 1rem">
        <button type="button"
                class="btn btn-secondary m-1"
                (click)="onBack()"
                title="К таблице пользователей">
          Назад
        </button>
        <button class="btn btn-primary m-1"
                [disabled]="!isUpdated()"
                title="Сохранить изменения">
          Сохранить
        </button>
      </div>
    </form>
  </div>
</div>
